<!DOCTYPE html>
<html lang="pt-BR" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meu Placar</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
        
    <!-- PWA Theme Color -->
    <meta name="theme-color" id="theme-color-meta" content="#111827">

    <style>
        :root {
            --theme-primary: #10B981;
            --theme-background: #111827;
        }
        
        html.light {
            --theme-background: #F3F4F6;
        }

        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
            background-color: var(--theme-background);
            color: #F9FAFB;
            transition: background-color 0.5s ease-out;
        }

        html.light body {
            color: #1F2937;
        }
        
        .bg-theme-primary { background-color: var(--theme-primary); }
        .text-theme-primary { color: var(--theme-primary); }
        
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9) rotate(-4deg); } 
            to { opacity: 1; transform: scale(1) rotate(0deg); }
        }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .animate-scale-in { animation: scaleIn 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }
        .animate-fade-in-up { animation: fadeInUp 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }

        .stagger-children > * { opacity: 0; }
        .modal-content { background-color: #2a2a2e; }
        html.light .modal-content { background-color: #ffffff; }
    </style>
</head>
<body id="app-body">

    <div id="app" class="max-w-4xl mx-auto min-h-screen flex flex-col">
        <!-- Header -->
        <header id="app-header" class="bg-black/30 backdrop-blur-sm text-white p-4 sticky top-0 z-40 flex justify-between items-center transition-colors duration-500 border-b border-white/10">
            <div class="flex items-center gap-3" id="header-main-title">
                 <svg id="header-logo" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-theme-primary"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></svg>
                <h1 id="header-title" class="text-xl font-bold">Meu Placar</h1>
            </div>
            <div class="flex items-center gap-2">
                 <button id="settings-button" class="p-2 rounded-full hover:bg-white/10 transition-all">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                </button>
                <button id="install-button" class="hidden bg-white/90 text-gray-900 font-semibold py-2 px-3 rounded-lg shadow-md hover:bg-white transition-all duration-200 text-sm flex items-center gap-2 backdrop-blur-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/></svg>
                    Instalar
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main id="content" class="p-4 flex-grow">
             <!-- Widgets dos times serão injetados aqui -->
        </main>
        
        <footer class="text-center p-4 text-xs text-gray-400 border-t border-white/10">
            Meu Placar PWA &copy; 2024
        </footer>
    </div>
    
    <!-- Settings Modal -->
    <div id="settings-modal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4">
        <div class="modal-content w-full max-w-md rounded-xl shadow-lg p-6 animate-fade-in-up text-white">
            <h2 class="text-2xl font-bold mb-6 text-black dark:text-white">Configurações</h2>
            
            <div class="space-y-6">
                <!-- Theme Toggle -->
                <div class="flex items-center justify-between bg-gray-100 dark:bg-black/20 p-4 rounded-lg">
                    <span class="font-semibold text-black dark:text-white">Modo Escuro</span>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="theme-toggle" class="sr-only peer">
                        <div class="w-11 h-6 bg-gray-300 dark:bg-gray-600 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-theme-primary"></div>
                    </label>
                </div>

                <!-- Edit Teams -->
                <div>
                    <h3 class="font-bold text-lg mb-3 text-black dark:text-white">Editar Times</h3>
                    <div id="edit-teams-list" class="space-y-2">
                        <!-- Botões de edição dos times serão injetados aqui -->
                    </div>
                </div>
            </div>
            <div class="flex justify-end gap-3 mt-8 border-t border-gray-200 dark:border-white/10 pt-4">
                 <button id="cancel-settings-button" class="bg-gray-200 dark:bg-black/20 text-gray-700 dark:text-gray-300 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-black/40">Cancelar</button>
                 <button id="save-settings-button" class="bg-theme-primary text-white font-semibold py-2 px-4 rounded-lg hover:opacity-90">Salvar e Fechar</button>
             </div>
        </div>
    </div>
    
    <!-- Edit Team Modal -->
    <div id="edit-team-modal" class="hidden fixed inset-0 bg-black/60 backdrop-blur-sm z-[60] flex items-center justify-center p-4">
        <div class="modal-content w-full max-w-md rounded-xl shadow-lg p-6 animate-fade-in-up">
             <h2 class="text-2xl font-bold text-black dark:text-white mb-4">Editar Time</h2>
             <input type="hidden" id="edit-team-id">
             <div class="space-y-4">
                 <div>
                     <label for="edit-team-name" class="block text-sm font-medium text-gray-600 dark:text-gray-300 mb-1">Nome do Time</label>
                     <input type="text" id="edit-team-name" class="w-full bg-gray-100 dark:bg-black/20 border border-gray-300 dark:border-white/20 text-black dark:text-white rounded-lg p-2 focus:ring-2 focus:ring-theme-primary focus:border-theme-primary outline-none">
                 </div>
                 <div>
                     <label for="edit-team-logo" class="block text-sm font-medium text-gray-600 dark:text-gray-300 mb-1">URL do Escudo</label>
                     <input type="text" id="edit-team-logo" class="w-full bg-gray-100 dark:bg-black/20 border border-gray-300 dark:border-white/20 text-black dark:text-white rounded-lg p-2 focus:ring-2 focus:ring-theme-primary focus:border-theme-primary outline-none">
                 </div>
             </div>
             <div class="flex justify-end gap-3 mt-6">
                 <button id="cancel-edit-button" class="bg-gray-200 dark:bg-black/20 text-gray-700 dark:text-gray-300 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 dark:hover:bg-black/40">Cancelar</button>
                 <button id="save-edit-button" class="bg-theme-primary text-white font-semibold py-2 px-4 rounded-lg hover:opacity-90">Salvar Alteração</button>
             </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            setupPWA();

            // --- DADOS MOCK (PADRÃO) ---
            const defaultApiData = {
                palmeiras: { overview: { latestResult: { opponent: "Corinthians", score: "2 - 1" }}},
                rio_branco: { overview: { latestResult: { opponent: "Noroeste", score: "0 - 0" }}},
                packers: { overview: { latestResult: { opponent: "Chicago Bears", score: "17 - 9" }}},
                brasil: { overview: { latestResult: { opponent: "Argentina", score: "0 - 1" }}}
            };
            
            let teamsData;
            let tempTeamsData;
            const contentEl = document.getElementById('content');
            const settingsModal = document.getElementById('settings-modal');
            const editTeamModal = document.getElementById('edit-team-modal');
            const defaultBg = '#111827';

            function loadAndInitializeData() {
                const savedTheme = localStorage.getItem('placarTheme');
                const savedTeams = localStorage.getItem('placarTeamsData');
                document.documentElement.classList.toggle('light', savedTheme === 'light');
                if (savedTeams) {
                    teamsData = JSON.parse(savedTeams);
                } else {
                    teamsData = {
                        palmeiras: { id: 'palmeiras', page: 'palmeiras.html', displayName: 'Palmeiras', logo: 'https://upload.wikimedia.org/wikipedia/commons/1/10/Palmeiras_logo.svg', theme: { primary: '#00B945', background: '#01321A' }, liveData: defaultApiData.palmeiras },
                        rio_branco: { id: 'rio_branco', page: 'rio_branco.html', displayName: 'Rio Branco', logo: 'https://upload.wikimedia.org/wikipedia/pt/4/48/Riobrancosp.png', theme: { primary: '#FFFFFF', background: '#1C1C1C' }, liveData: defaultApiData.rio_branco },
                        packers: { id: 'packers', page: 'packers.html', displayName: 'Packers', logo: 'https://upload.wikimedia.org/wikipedia/commons/5/50/Green_Bay_Packers_logo.svg', theme: { primary: '#FFB612', background: '#182E2B' }, liveData: defaultApiData.packers },
                        brasil: { id: 'brasil', page: 'brasil.html', displayName: 'Brasil', logo: 'https://upload.wikimedia.org/wikipedia/pt/b/b9/Logo_CBF_2019.svg', theme: { primary: '#FFDC00', background: '#001A4C' }, liveData: defaultApiData.brasil }
                    };
                }
            }

            function saveAllSettings() {
                localStorage.setItem('placarTheme', document.documentElement.classList.contains('light') ? 'light' : 'dark');
                teamsData = JSON.parse(JSON.stringify(tempTeamsData));
                localStorage.setItem('placarTeamsData', JSON.stringify(teamsData));
                renderDashboard();
            }
            
            const applyTheme = (theme) => {
                document.documentElement.style.setProperty('--theme-primary', theme.primary);
                document.documentElement.style.setProperty('--theme-background', theme.background);
                document.getElementById('theme-color-meta').setAttribute('content', theme.background);
            };

            const renderDashboard = () => {
                const isLight = document.documentElement.classList.contains('light');
                applyTheme({ primary: '#10B981', background: isLight ? '#F3F4F6' : defaultBg });
                
                let widgetsHtml = '<div class="grid grid-cols-2 gap-4 stagger-children">';
                Object.values(teamsData).forEach(team => {
                    const bgColor = isLight ? 'bg-white' : 'bg-gray-800/50 backdrop-blur-sm';
                    const textColor = isLight ? 'text-gray-900' : 'text-white';
                    const subTextColor = isLight ? 'text-gray-500' : 'text-gray-300';
                    const borderColor = isLight ? 'border-gray-200' : 'border-white/10';

                    widgetsHtml += `
                        <a href="${team.page}" class="team-widget block ${bgColor} rounded-xl shadow-lg p-4 flex flex-col items-center text-center cursor-pointer hover:shadow-2xl hover:-translate-y-1.5 transition-all duration-300 overflow-hidden" style="border-bottom: 4px solid ${team.theme.primary}">
                            <img src="${team.logo}" alt="${team.displayName}" class="h-16 w-16 object-contain mb-3">
                            <h3 class="font-bold ${textColor}">${team.displayName}</h3>
                            <div class="text-xs ${subTextColor} mt-2 border-t ${borderColor} w-full pt-2">
                                <p class="font-semibold">Último Placar:</p>
                                <p>${team.liveData.overview.latestResult.score} vs ${team.liveData.overview.latestResult.opponent}</p>
                            </div>
                        </a>`;
                });
                widgetsHtml += '</div>';
                contentEl.innerHTML = widgetsHtml;
                contentEl.querySelectorAll('.stagger-children > *').forEach((child, index) => {
                    child.classList.add('animate-scale-in');
                    child.style.animationDelay = `${index * 100 + 200}ms`;
                });
            };

            function openSettingsModal() {
                tempTeamsData = JSON.parse(JSON.stringify(teamsData));
                document.getElementById('theme-toggle').checked = !document.documentElement.classList.contains('light');
                renderEditTeamsList();
                settingsModal.classList.remove('hidden');
            }
            
            function renderEditTeamsList() {
                const editList = document.getElementById('edit-teams-list');
                editList.innerHTML = '';
                Object.values(tempTeamsData).forEach(team => {
                    const button = document.createElement('button');
                    const isLight = document.documentElement.classList.contains('light');
                    button.className = `w-full text-left p-3 rounded-lg flex items-center justify-between ${isLight ? 'bg-gray-100 hover:bg-gray-200' : 'bg-black/20 hover:bg-black/40'}`;
                    button.innerHTML = `<div class="flex items-center gap-3">
                        <img src="${team.logo}" class="w-8 h-8 object-contain rounded-full">
                        <span class="font-semibold ${isLight ? 'text-black' : 'text-white'}">${team.displayName}</span>
                    </div>
                    <span class="text-sm ${isLight ? 'text-gray-500' : 'text-gray-400'}">Editar</span>`;
                    button.onclick = () => openEditTeamModal(team.id);
                    editList.appendChild(button);
                });
            }

            function closeSettingsModal() { settingsModal.classList.add('hidden'); }
            
            function openEditTeamModal(teamId) {
                const team = tempTeamsData[teamId];
                document.getElementById('edit-team-id').value = teamId;
                document.getElementById('edit-team-name').value = team.displayName;
                document.getElementById('edit-team-logo').value = team.logo;
                editTeamModal.classList.remove('hidden');
            }

            function closeEditTeamModal() { editTeamModal.classList.add('hidden'); }
            
            function saveTeamChanges() {
                const teamId = document.getElementById('edit-team-id').value;
                tempTeamsData[teamId].displayName = document.getElementById('edit-team-name').value;
                tempTeamsData[teamId].logo = document.getElementById('edit-team-logo').value;
                closeEditTeamModal();
                renderEditTeamsList();
            }
            
            // --- Event Listeners ---
            document.getElementById('settings-button').addEventListener('click', openSettingsModal);
            document.getElementById('save-settings-button').addEventListener('click', () => { saveAllSettings(); closeSettingsModal(); });
            document.getElementById('cancel-settings-button').addEventListener('click', closeSettingsModal);
            document.getElementById('theme-toggle').addEventListener('change', (e) => {
                document.documentElement.classList.toggle('light', !e.target.checked);
            });
            document.getElementById('save-edit-button').addEventListener('click', saveTeamChanges);
            document.getElementById('cancel-edit-button').addEventListener('click', closeEditTeamModal);
            
            // --- Inicialização ---
            loadAndInitializeData();
            renderDashboard();
        });

        function setupPWA() {
            const manifest={name:"Meu Placar PWA",short_name:"Meu Placar",start_url:"./index.html",display:"standalone",background_color:"#111827",theme_color:"#111827",icons:[{src:"https://placehold.co/192x192/1F2937/FFFFFF?text=MP",sizes:"192x192",type:"image/png"},{src:"https://placehold.co/512x512/1F2937/FFFFFF?text=MP",sizes:"512x512",type:"image/png"}]},manifestURL=URL.createObjectURL(new Blob([JSON.stringify(manifest)],{type:"application/json"}));document.head.appendChild(Object.assign(document.createElement("link"),{rel:"manifest",href:manifestURL}));if("serviceWorker"in navigator){const e="const CACHE_NAME = 'meu-placar-cache-v21'; const urlsToCache = ['./index.html', './palmeiras.html', './rio_branco.html', './packers.html', './brasil.html']; self.addEventListener('install', e => e.waitUntil(caches.open(CACHE_NAME).then(c => c.addAll(urlsToCache)))); self.addEventListener('fetch', e => e.respondWith(caches.match(e.request).then(r => r || fetch(e.request)))); self.addEventListener('activate', e => e.waitUntil(caches.keys().then(names => Promise.all(names.map(name => name !== CACHE_NAME ? caches.delete(name) : null)))));",t=URL.createObjectURL(new Blob([e],{type:"application/javascript"}));navigator.serviceWorker.register(t).catch(e=>console.error("SW Error:",e))}let e;const t=document.getElementById("install-button");window.addEventListener("beforeinstallprompt",o=>{o.preventDefault(),e=o,t.classList.remove("hidden")}),t.addEventListener("click",async()=>{e&&(e.prompt(),await e.userChoice,e=null,t.classList.add("hidden"))})}
    </script>
</body>
</html>
